# üöó Viamentor - Contexte Projet pour Cursor AI

## üìã Vue d'Ensemble

**Viamentor** est une plateforme SaaS compl√®te de gestion d'auto-√©coles en Suisse, permettant de g√©rer les √©l√®ves, moniteurs, cours th√©oriques, le√ßons pratiques, examens, paiements et bien plus.

### Objectif Principal
Digitaliser compl√®tement la gestion d'une auto-√©cole avec:
- Gestion √©l√®ves/moniteurs/v√©hicules
- Planification cours th√©oriques (CTC/Premier Secours/Sensibilisation)
- R√©servation le√ßons pratiques
- Attribution intelligente √©l√®ves-moniteurs
- Facturation & paiements
- Tableau de bord analytics
- Multi-√©cole (franchises)

### Public Cible
- Auto-√©coles suisses (FR/DE/IT/EN)
- Moniteurs ind√©pendants
- √âl√®ves conducteurs
- Administrateurs d'√©coles
- Franchises multi-sites

---

## üõ†Ô∏è Stack Technique

### Frontend
```json
{
  "framework": "React 19 + Vite 6.2 (SPA)",
  "language": "TypeScript 5.7+",
  "styling": "Tailwind CSS 3.4+",
  "ui": "shadcn/ui + Radix UI",
  "state": "TanStack Query (React Query) + Zustand",
  "forms": "React Hook Form + Zod",
  "i18n": "Custom i18n (FR/DE/IT/EN)",
  "charts": "Recharts + ECharts + Plotly",
  "calendar": "FullCalendar + react-big-calendar",
  "icons": "Lucide React + Heroicons",
  "animations": "Framer Motion",
  "routing": "React Router DOM"
}
```

### Backend (En cours de connexion)
```json
{
  "database": "Supabase (PostgreSQL)",
  "auth": "Supabase Auth",
  "storage": "Supabase Storage",
  "api": "Supabase RLS + Edge Functions (future)",
  "email": "√Ä d√©finir (Resend/SendGrid)",
  "sms": "√Ä d√©finir (Twilio)",
  "payments": "QR-factures suisses",
  "pdf": "jsPDF + jspdf-autotable"
}
```

### DevOps
```json
{
  "hosting": "√Ä d√©finir (Vercel recommand√©)",
  "ci_cd": "√Ä cr√©er (GitHub Actions)",
  "monitoring": "√Ä d√©finir (Sentry)",
  "analytics": "√Ä d√©finir (GA4)"
}
```

---

## üìÅ Structure du Projet

```
viamentor/
‚îú‚îÄ‚îÄ src/
‚îÇ   ‚îú‚îÄ‚îÄ components/
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ ui/                      # shadcn/ui base components (50+)
‚îÇ   ‚îú‚îÄ‚îÄ hooks/                       # Custom React hooks
‚îÇ   ‚îú‚îÄ‚îÄ lib/                         # Utilitaires
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ supabase.ts             # Client Supabase
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ utils.ts                # Utilitaires
‚îÇ   ‚îú‚îÄ‚îÄ viamentor/                    # Code m√©tier Viamentor
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ components/             # 370+ composants m√©tier
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ data/                   # 370+ fichiers data/i18n/schemas
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ layouts/                # Layouts (MainLayout)
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ pages/                  # 189 pages/routes
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ plans/                  # 74 docs architecture
‚îÇ   ‚îú‚îÄ‚îÄ App.tsx                     # Router principal
‚îÇ   ‚îî‚îÄ‚îÄ main.tsx                    # Entry point
‚îÇ
‚îú‚îÄ‚îÄ public/                          # Assets statiques
‚îú‚îÄ‚îÄ audit/                          # Audit professionnel complet
‚îÇ   ‚îú‚îÄ‚îÄ 00-SOMMAIRE-AUDIT.md
‚îÇ   ‚îú‚îÄ‚îÄ 01 √† 15 audits r√¥les
‚îÇ   ‚îú‚îÄ‚îÄ 99-ACTION-PLAN.md
‚îÇ   ‚îî‚îÄ‚îÄ CONTEXTE.md                # Ce fichier
‚îÇ
‚îú‚îÄ‚îÄ .env.local                      # Config locale (NON COMMIT√â)
‚îú‚îÄ‚îÄ package.json                    # D√©pendances
‚îú‚îÄ‚îÄ vite.config.ts                  # Config Vite
‚îú‚îÄ‚îÄ tailwind.config.js              # Config Tailwind
‚îî‚îÄ‚îÄ tsconfig.json                   # Config TypeScript
```

---

## üéØ Fonctionnalit√©s Principales

### ‚úÖ Compl√©t√©es (Phase 1 - Frontend Mock)

#### 1. **Gestion √âl√®ves**
- CRUD √©l√®ves complet
- Profils d√©taill√©s (identit√©, formation, documents)
- Historique le√ßons/examens/paiements
- Progression formation
- Notes internes
- Import/Export CSV

#### 2. **Gestion Moniteurs**
- CRUD moniteurs
- Disponibilit√©s calendrier
- Cat√©gories autoris√©es (A/B/C/D/Moto)
- Langues parl√©es
- √âvaluations/avis
- Performance tracking

#### 3. **Attribution √âl√®ves-Moniteurs**
- Algorithme workload balancing intelligent
- Recommandations automatiques
- Propositions moniteurs ‚Üí validation √©cole
- Acc√®s temporaires
- Historique complet
- Analytics attribution

#### 4. **Cours Th√©oriques**
- Cat√©gories (CTC/Premier Secours/Sensibilisation/Moto)
- Types de cours (semaine/weekend/intensif)
- Structure s√©ances multiples
- Calendrier drag & drop
- Gestion participants
- Validation pr√©sences
- G√©n√©ration attestations PDF
- Email certificats

#### 5. **Planning & Le√ßons**
- Calendrier le√ßons pratiques
- R√©servation/Annulation
- D√©tection conflits
- Export ICS
- Vue journ√©e/semaine/mois

#### 6. **Facturation**
- G√©n√©ration factures
- QR-factures suisses
- Suivi paiements
- Relances automatiques
- Analytics revenus

#### 7. **Tableau de Bord**
- Dashboard √©cole (stats, KPIs, charts)
- Dashboard moniteur (planning, √©l√®ves)
- Dashboard √©l√®ve (progression, le√ßons)
- Dashboard secr√©taire (t√¢ches quotidiennes)
- 15 r√¥les RBAC diff√©renci√©s

#### 8. **Syst√®me**
- Multi-tenant architecture
- i18n FR/DE/IT/EN complet
- Notifications center
- Search global
- Quick actions bar
- Responsive mobile
- Light/Dark mode
- Onboarding wizard

### ‚è≥ En Cours

- Connexion backend Supabase
- Tests unitaires
- Tests E2E
- CI/CD pipeline
- Documentation utilisateur

### üîú √Ä Venir (Phase 2 - Backend)

- Supabase int√©gration compl√®te
- Authentication r√©elle
- API s√©curis√©es
- RLS Policies
- Email/SMS int√©grations
- Stripe paiements
- Tests automatis√©s
- Production deployment

---

## üìê Architecture & Patterns

### Design Patterns Utilis√©s

1. **Component Pattern**: Composants r√©utilisables UI
2. **Container/Presenter**: S√©paration logique/affichage
3. **Custom Hooks**: Logique m√©tier encapsul√©e
4. **Service Layer**: Services m√©tier isol√©s
5. **Mock/Real Toggle**: Switch mock data ‚Üî Supabase
6. **Strategy Pattern**: Algorithmes configurables

### Principes SOLID

- **S**ingle Responsibility: 1 composant = 1 responsabilit√©
- **O**pen/Closed: Extensions sans modifications
- **L**iskov Substitution: Types interchangeables
- **I**nterface Segregation: Interfaces sp√©cifiques
- **D**ependency Inversion: D√©pendre abstractions

### Clean Code Rules
```typescript
// ‚úÖ BON: Composant 200-250 lignes max
// ‚úÖ BON: Noms descriptifs explicites
// ‚úÖ BON: Early returns validation
// ‚úÖ BON: Commentaires seulement si n√©cessaire
// ‚úÖ BON: Fonctions pures quand possible
// ‚úÖ BON: TypeScript strict mode
// ‚úÖ BON: Pas de `any` types
```

---

## üé® Conventions de Code

### Naming Conventions
```typescript
// Composants: PascalCase
StudentProfileCard.tsx
InstructorAssignmentWizard.tsx

// Fonctions: camelCase
calculateWorkloadScore()
generateCertificatePDF()

// Types/Interfaces: PascalCase
StudentFormData
InstructorProfile
CourseCategory

// Constants: SCREAMING_SNAKE_CASE
MAX_STUDENTS_PER_INSTRUCTOR = 12
DEFAULT_LESSON_DURATION = 50

// Fichiers services: kebab-case
assignment-algorithm.service.ts
certificates-pdf.service.ts

// Fichiers data: viamentor-*-data.ts
viamentor-students-data.ts
viamentor-courses-data.ts

// Fichiers i18n: viamentor-*-i18n.ts
viamentor-students-i18n.ts
viamentor-courses-i18n.ts
```

### File Organization
```typescript
// Structure composant type:
// 1. Imports externes
import React from 'react';
import { useQuery } from '@tanstack/react-query';

// 2. Imports internes
import { Button } from '@/components/ui/button';
import { Card } from '@/components/ui/card';

// 3. Types locaux
interface StudentCardProps {
  student: Student;
  onEdit: (id: string) => void;
}

// 4. Composant principal
export function StudentCard({ student, onEdit }: StudentCardProps) {
  // Hooks
  const { data, isLoading } = useQuery(/*...*/);
  
  // Early returns
  if (isLoading) return <div>Loading...</div>;
  if (!data) return null;
  
  // Event handlers
  const handleEdit = () => onEdit(student.id);
  
  // Render
  return (
    <Card>
      {/* JSX */}
    </Card>
  );
}

// 5. Exports nomm√©s secondaires
export { type StudentCardProps };
```

### TypeScript Strict Rules
```typescript
// ‚ùå INTERDIT
const user: any = getUserData(); // Pas de `any`
function doSomething(data) { } // Types requis

// ‚úÖ OBLIGATOIRE
const user: User = getUserData();
function doSomething(data: FormData): Promise<void> { }

// Type guards
if (typeof value === 'string') { }
if (Array.isArray(items)) { }
if ('email' in user) { }
```

### React Best Practices
```typescript
// ‚úÖ Memoization composants lourds
export const StudentCard = React.memo(function StudentCard(props) {
  // ...
});

// ‚úÖ useMemo calculs co√ªteux
const sortedStudents = useMemo(
  () => students.sort((a, b) => a.name.localeCompare(b.name)),
  [students]
);

// ‚úÖ useCallback event handlers
const handleSubmit = useCallback((data: FormData) => {
  submitStudent(data);
}, [submitStudent]);

// ‚úÖ Custom hooks logique r√©utilisable
function useStudentForm(initialData?: Student) {
  const [data, setData] = useState(initialData);
  // ...
  return { data, handleChange, handleSubmit };
}
```

---

## üîß Configuration Environnement

### Variables Environnement (`.env.local`)
```bash
# Supabase (Configur√©)
VITE_SUPABASE_URL=https://jdyuulqscwxlkswmceqp.supabase.co
VITE_SUPABASE_ANON_KEY=[CONFIGUR√â]
DATABASE_URL=postgresql://postgres:[PASSWORD]@db.jdyuulqscwxlkswmceqp.supabase.co:5432/postgres

# Future (Phase 2)
VITE_STRIPE_PUBLISHABLE_KEY=
VITE_RESEND_API_KEY=
VITE_TWILIO_ACCOUNT_SID=
```

---

## üöÄ Commandes Utiles
```bash
# Installation
npm install

# D√©veloppement
npm run dev          # Port 5173 (Vite)

# Build production
npm run build
npm run preview

# Linting
npm run lint

# Type checking
npx tsc --noEmit

# Tests (√Ä cr√©er)
npm run test
npm run test:e2e
```

---

## üìä √âtat Actuel du Projet

### Phase Actuelle: **PROTOTYPE AVANC√â - Frontend Mock Data**

#### ‚úÖ Termin√© (Audit Score 4.5/10)
- [x] Architecture React + Vite
- [x] Configuration Tailwind + shadcn/ui
- [x] i18n 4 langues (FR/DE/IT/EN)
- [x] Layout Dashboard responsive
- [x] 370+ composants m√©tier cr√©√©s
- [x] 189 pages/routes d√©finies
- [x] Mock data complet
- [x] Supabase connect√© (client ready)
- [x] Git + GitHub configur√©
- [x] Audit professionnel 15 r√¥les
- [x] Documentation technique (74 plans)

#### üèóÔ∏è En cours (Selon audit)
- [ ] Backend API (Score 2/10) üî¥ CRITIQUE
- [ ] Tests (Score 0/10) üî¥ CRITIQUE
- [ ] CI/CD (Score 3/10) üî¥
- [ ] Compliance l√©gale (Score 5/10) üü°
- [ ] Analytics (Score 1/10) üî¥
- [ ] Documentation utilisateur (Score 6/10) üü°

#### ‚è∞ Reste selon Plan 12 semaines
- Backend complet (4 semaines)
- Tests 80% coverage (3 semaines)
- CGU/RGPD (3 semaines)
- Validation march√© (2 semaines)
- Customer Success (2 semaines)

### Prochaine Phase: **PHASE 2 - Production Ready (12 semaines)**

---

## üéØ Objectifs Imm√©diats

### Pour Cursor AI, je veux que tu m'aides √†:

1. **Terminer Migration Supabase**
   - Remplacer mock data par vraies queries
   - Impl√©menter auth flow
   - Cr√©er migrations SQL
   - Tester connexion DB

2. **Cr√©er Tests**
   - Installer Vitest + Playwright
   - Tests unitaires utils/hooks
   - Tests E2E parcours critiques
   - Coverage 80%+

3. **Setup CI/CD**
   - GitHub Actions workflow
   - Lint + TypeCheck + Tests
   - Deploy automatique Vercel
   - Monitoring Sentry

4. **Maintenir Qualit√© Code**
   - Respecter conventions naming
   - Garder composants <250 lignes
   - TypeScript strict
   - Documentation code complexe

---

## üìö Ressources & R√©f√©rences

### Documentation Officielle
- React: https://react.dev
- Vite: https://vitejs.dev
- Tailwind CSS: https://tailwindcss.com/docs
- shadcn/ui: https://ui.shadcn.com
- Radix UI: https://www.radix-ui.com
- TanStack Query: https://tanstack.com/query
- Supabase: https://supabase.com/docs
- React Router: https://reactrouter.com

### Inspirations Design
- SARI CTC/IPB (syst√®me suisse auto-√©coles)
- Google Calendar (planning drag & drop)
- Stripe Dashboard (clean UI/UX)
- Linear (workflow fluide)

---

## ‚ö†Ô∏è R√®gles Importantes pour Cursor

### √Ä TOUJOURS RESPECTER

1. **TypeScript Strict**: Pas de `any`, types explicites partout
2. **Composants <250 lignes**: Si plus long, d√©couper en sous-composants
3. **Naming Conventions**: Respecter PascalCase/camelCase/kebab-case
4. **i18n**: Tout texte UI doit √™tre dans fichiers i18n
5. **Responsive**: Mobile-first, tester 3 breakpoints
6. **Accessibility**: ARIA labels, keyboard navigation
7. **Performance**: React.memo si >100 lignes
8. **Clean Code**: Early returns, pas de nested if >3 niveaux
9. **Mock Data Phase 1**: Utiliser `data/viamentor-*-data.ts`
10. **Comments**: Seulement pour logique complexe

### √Ä NE JAMAIS FAIRE

‚ùå Utiliser `any` types TypeScript  
‚ùå Texte hardcod√© (toujours passer par i18n)  
‚ùå Composants >300 lignes sans d√©coupage  
‚ùå Console.log en production  
‚ùå Inline styles (toujours Tailwind)  
‚ùå Nested if >3 niveaux (early returns)  
‚ùå Magic numbers (utiliser constantes)  
‚ùå Code dupliqu√© (extraire hooks/utils)  
‚ùå Imports chemins absolus sans alias @/  
‚ùå Modifier node_modules  

---

## ü§ù Comment M'Aider (Cursor)

### Quand je te demande du code:

1. **Comprendre le contexte**: Quelle page/feature? Quelle phase?
2. **Respecter l'architecture**: Structure dossiers existante
3. **TypeScript strict**: Types explicites, pas d'any
4. **Clean Code**: Commentaires minimum, noms descriptifs
5. **i18n ready**: Pr√©voir traductions 4 langues
6. **Responsive**: Mobile-first approach
7. **Performance**: Optimisations n√©cessaires
8. **Tester**: V√©rifier TypeScript compile

### Format R√©ponses Id√©al:
```typescript
// 1. Expliquer bri√®vement ce que fait le code
// 2. Fournir code complet pr√™t √† copier-coller
// 3. Indiquer o√π placer le fichier
// 4. Mentionner d√©pendances si n√©cessaires
// 5. Donner exemple d'utilisation
```

---

## üìä R√©sultats Audit (Score 4.5/10)

### üü¢ Points Forts
- Frontend Architect: **8/10** ‚≠ê
- UI Designer: **8/10** ‚≠ê
- React Developer: **7/10**
- UX Designer: **7/10**
- Architecture excellente
- Design system coh√©rent

### üî¥ Points Critiques
- Backend Developer: **2/10** (inexistant)
- QA Automation: **0/10** (aucun test)
- QA Manual: **1/10** (pas de plan)
- Data/Analytics: **1/10** (pas de tracking)
- DevOps: **3/10** (pas de CI/CD)

### Bloqueurs Production (Top 5)
1. Backend inexistant (4 sem, 25K CHF)
2. Aucun test (3 sem, 15K CHF)
3. CGU/Privacy manquantes (3 sem, 12K CHF)
4. Validation march√© 0 (2 sem, 5K CHF)
5. Monitoring absent (1 sem, 3K CHF)

---

## üéì Pour Bien D√©marrer

### Comprends d'abord:
1. Lis `audit/00-SOMMAIRE-AUDIT.md`
2. Explore structure `/src/viamentor/`
3. Regarde composants `/src/components/ui/`
4. Check mock data `/src/viamentor/data/`
5. Vois layouts `/src/viamentor/layouts/`

### Ensuite:
1. Identifie feature √† travailler
2. V√©rifie conventions naming
3. Respecte architecture existante
4. Code propre TypeScript strict
5. Test responsive + i18n

---

## üìû Informations Compl√©mentaires

**Projet**: Viamentor - Plateforme SaaS Auto-√âcoles Suisse  
**Phase Actuelle**: Prototype Frontend (Mock Data)  
**Score Audit**: 4.5/10 (Bon prototype, incomplet production)  
**Timeline Production**: 12 semaines estim√©es  
**Budget Estim√©**: 140'000 CHF  

**Database**: Supabase PostgreSQL (connect√©, tables √† cr√©er)  
**Auth**: Supabase Auth (mock actuellement)  
**Hosting**: Local dev (Vercel future)  

---

## üéØ Priorit√©s Actuelles (selon audit)

### P0 - URGENT (Bloqueurs production)
1. Cr√©er backend API (Supabase Edge Functions ou Next.js API)
2. Cr√©er tables Supabase (migrations SQL)
3. Impl√©menter tests (Vitest + Playwright)
4. R√©diger CGU/Privacy Policy
5. Setup CI/CD GitHub Actions

### P1 - Important
1. Validation march√© (5 interviews auto-√©coles)
2. Analytics GA4
3. Monitoring Sentry
4. Documentation utilisateur
5. Customer Success onboarding

### P2 - Nice to have
1. Storybook composants
2. Performance optimization
3. A11y improvements
4. Dark mode polish
5. Mobile app (future)

---

## üöÄ Utilisation avec Cursor

### R√©f√©rencer ce contexte:
```
@audit/CONTEXTE.md

[Votre question ici]
```

### Exemples questions:

**Cr√©er composant:**
```
@audit/CONTEXTE.md

Je veux cr√©er StudentProgressChart avec Recharts.
O√π le placer et comment structurer selon conventions?
```

**D√©bugger:**
```
@audit/CONTEXTE.md

Erreur TypeScript StudentForm.tsx ligne 45.
Comment corriger selon typage strict?
```

**Optimiser:**
```
@audit/CONTEXTE.md

Page /students lente avec 500+ √©l√®ves.
Optimiser selon best practices?
```

**Nouvelle feature:**
```
@audit/CONTEXTE.md

Ajouter syst√®me chat moniteur-√©l√®ve.
Architecture recommand√©e Phase 1 mock?
```

---

## üìã Checklist Avant Production

Voir `audit/99-ACTION-PLAN.md` pour d√©tails complets.

**Minimum viable (90/100 points requis):**
- [ ] Backend API complet (10 pts)
- [ ] Tests ‚â• 80% (8 pts)
- [ ] CI/CD < 15min (5 pts)
- [ ] Monitoring 24/7 (4 pts)
- [ ] Lighthouse > 90 (3 pts)
- [ ] Pentest pass√© (10 pts)
- [ ] 0 vulns critical (8 pts)
- [ ] Security headers (3 pts)
- [ ] CGU publi√©es (8 pts)
- [ ] Privacy policy (8 pts)
- [ ] Cookie consent (5 pts)
- [ ] DPA sign√©s (4 pts)
- [ ] 1 pilote NPS>50 (8 pts)
- [ ] Docs user (5 pts)
- [ ] Analytics (4 pts)
- [ ] Support ready (3 pts)

---

**Cursor, tu es maintenant pr√™t √† m'aider sur Viamentor! üöÄ**

**Questions? Demande-moi des pr√©cisions sur n'importe quel point.**

---

_Document cr√©√© le 28 octobre 2025_  
_Projet: Viamentor - SaaS Auto-√âcoles Suisse_  
_Phase: Prototype Frontend ‚Üí Production (12 semaines)_  
_Score Audit: 4.5/10 ‚Üí Cible: 9/10_

